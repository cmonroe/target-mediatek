From 00f7444ccc25ef5c06bfbba5e2ed57423af5dc81 Mon Sep 17 00:00:00 2001
From: Tim Hayes <tim.hayes@smartrg.com>
Date: Thu, 29 Jun 2023 08:37:51 -0700
Subject: [PATCH] OWRT-8536 net: bridge: switchdev: add hwdom zero check

---
 net/bridge/br_switchdev.c | 2 ++
 1 file changed, 2 insertions(+)

--- a/net/bridge/br_switchdev.c
+++ b/net/bridge/br_switchdev.c
@@ -65,6 +65,8 @@ bool nbp_switchdev_allowed_egress(const
 {
 	struct br_input_skb_cb *cb = BR_INPUT_SKB_CB(skb);
 
+	if (p->hwdom==0) return true;
+
 	return !test_bit(p->hwdom, &cb->fwd_hwdoms) &&
 		(!skb->offload_fwd_mark || cb->src_hwdom != p->hwdom);
 }
